<!DOCTYPE html><html lang="en" class="no-js" data-beasties-container><head>
<meta charset="UTF-8">
<title>Get Started</title>
<meta name="description" content="Djongo overcomes common pitfalls of PyMongo programming. It maps python objects to MongoDB documents. Setting up the mapping documents to python objects is easy with Djongo.">
<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Djongomapper">
<meta property="og:title" content="Djongo">
<meta property="og:url" content="https://www.djongomapper.com/">
<meta property="og:description" content="Djongo overcomes common pitfalls of PyMongo programming. It maps python objects to MongoDB documents. Setting up the mapping documents to python objects is easy with Djongo.">
<link rel="canonical" href="https://www.djongomapper.com/">
<script type="application/ld+json">
  {
    "@context": "https://schema.org",

      "@type": "Organization",
      "name": "Doableware",
      "url": "https://www.djongomapper.com/",
      "logo": "/assets/images/djongo-symbol-small.png"
  }
</script>
<meta name="google-site-verification" content="tFNu7Nc9hzKF9v7f6kYaoMbBCNyGREchcKMVdxJuyJo">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">
</noscript>
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" type="text/css" media="screen" href="/assets/css/custom.css">
<link rel="shortcut icon" href="/assets/images/favicon.ico">
<script async src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script async src="https://cdn.jsdelivr.net/npm/js-cookie@rc/dist/js.cookie.min.js"></script>
<!--<script async src="/assets/js/cookie-consent.js"></script>-->

<script>
  if (window.location.hostname != 'localhost'){
  (function (w, d, s, l, i) {
  w[l] = w[l] || [];
  w[l].push({
    'gtm.start':
      new Date().getTime(), event: 'gtm.js'
  });
  var f = d.getElementsByTagName(s)[0],
    j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : '';
  j.async = true;
  j.src =
    'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
  f.parentNode.insertBefore(j, f);
})(window, document, 'script', 'dataLayer', 'GTM-T72KG6N');
  }
</script>

  <base href="/">
  <style>html{scroll-behavior:smooth}
</style><link rel="stylesheet" href="styles-TPMX36DN.css" media="print" onload="this.media='all'"><noscript><link rel="stylesheet" href="styles-TPMX36DN.css"></noscript><style ng-app-id="ng">.body[_ngcontent-ng-c4210415865]{display:grid;grid-template-columns:minmax(min-content,calc(300px - 1rem)) minmax(600px,1280px) minmax(min-content,calc(300px - 1rem));grid-template-rows:calc(100vh - 3rem) auto;justify-content:center;gap:1rem;padding-left:1rem;padding-right:1rem}.body[_ngcontent-ng-c4210415865] > div[_ngcontent-ng-c4210415865]{grid-row:1/-1}.body[_ngcontent-ng-c4210415865] > aside[_ngcontent-ng-c4210415865]{grid-row:1}.nav[_ngcontent-ng-c4210415865]{padding-top:1rem;padding-bottom:1rem;font-size:.7rem}.nav-sticky[_ngcontent-ng-c4210415865]{position:sticky;top:3rem;overflow:auto}.nav-side[_ngcontent-ng-c4210415865]   h3[_ngcontent-ng-c4210415865]{font-size:.7rem;opacity:.7;text-transform:uppercase;border-bottom:1px solid #f2f3f3;margin:.5rem 0;padding:.25rem 0}.nav-side[_ngcontent-ng-c4210415865]   a[_ngcontent-ng-c4210415865]{color:inherit;opacity:.7}.nav-side[_ngcontent-ng-c4210415865]   .active[_ngcontent-ng-c4210415865]{font-weight:700;opacity:1}.nav-side[_ngcontent-ng-c4210415865]   a[_ngcontent-ng-c4210415865]:hover{opacity:1}.nav-toc[_ngcontent-ng-c4210415865]   h3[_ngcontent-ng-c4210415865]{font-size:.75rem;font-weight:700;color:#fff;background:#6f777d;border-top-left-radius:4px;border-top-right-radius:4px;padding:.5rem .75rem;margin:0}.nav-toc[_ngcontent-ng-c4210415865]   a[_ngcontent-ng-c4210415865]{display:block;padding:.25rem .75rem;color:#646769;font-weight:700;line-height:1.5;border-bottom:1px solid #f2f3f3;border-left:1px solid #f2f3f3;border-right:1px solid #f2f3f3}.nav-toc[_ngcontent-ng-c4210415865]   a[_ngcontent-ng-c4210415865]:hover{text-decoration:underline}.nav-toc[_ngcontent-ng-c4210415865]   li[_ngcontent-ng-c4210415865]   li[_ngcontent-ng-c4210415865] > a[_ngcontent-ng-c4210415865]{font-weight:400;padding-left:1rem}.nav-toc[_ngcontent-ng-c4210415865]   .active[_ngcontent-ng-c4210415865]{background-color:#e2e4e5}.sidebar[_ngcontent-ng-c4210415865]{opacity:1}.sidebar[_ngcontent-ng-c4210415865]   li[_ngcontent-ng-c4210415865]{font-size:.7rem}.page__content[_ngcontent-ng-c4210415865]{margin-top:1em}</style></head>
  <body><!--nghm--><script type="text/javascript" id="ng-event-dispatch-contract">(()=>{function p(t,n,r,o,e,i,f,m){return{eventType:t,event:n,targetElement:r,eic:o,timeStamp:e,eia:i,eirp:f,eiack:m}}function u(t){let n=[],r=e=>{n.push(e)};return{c:t,q:n,et:[],etc:[],d:r,h:e=>{r(p(e.type,e,e.target,t,Date.now()))}}}function s(t,n,r){for(let o=0;o<n.length;o++){let e=n[o];(r?t.etc:t.et).push(e),t.c.addEventListener(e,t.h,r)}}function c(t,n,r,o,e=window){let i=u(t);e._ejsas||(e._ejsas={}),e._ejsas[n]=i,s(i,r),s(i,o,!0)}window.__jsaction_bootstrap=c;})();
</script><script>window.__jsaction_bootstrap(document.body,"ng",["click"],[]);</script>
  <app-root ng-version="19.2.0" ngh="2" ng-server-context="ssg"><router-outlet></router-outlet><ng-component _nghost-ng-c4210415865 ngh="1"><app-body _ngcontent-ng-c4210415865 ngh="0"><div class="layout--splash"><nav class="skip-links"><ul><li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li><li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li><li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li></ul></nav><div class="masthead"><div class="masthead__inner-wrap"><div class="masthead__menu"><nav id="site-nav" class="greedy-nav"><a href="/" class="site-logo"><img src="/assets/images/djongo-symbol-small.png" alt="Djongo"></a><a href="/" class="site-title"> Djongo </a><ul class="visible-links"><li class="masthead__menu-item"><a href="/djongocs/login/">Login</a></li><li class="masthead__menu-item"><a href="/djongocs/contact-us/">Contact Us</a></li><li class="masthead__menu-item"><a href="/app-development/">Services</a></li><li class="masthead__menu-item"><a href="/products/">Products</a></li><li class="masthead__menu-item"><a href="/docs/get-started/">Docs</a></li></ul><button type="button" class="greedy-nav__toggle hidden"><span class="visually-hidden">Toggle Menu</span><div class="navicon"></div></button><ul class="hidden-links hidden"></ul></nav></div></div></div><div class="initial-content"><div _ngcontent-ng-c4210415865 class="body"><aside _ngcontent-ng-c4210415865 class="nav-sticky"><nav _ngcontent-ng-c4210415865 class="nav nav-side"><ul _ngcontent-ng-c4210415865><li _ngcontent-ng-c4210415865><h3 _ngcontent-ng-c4210415865>Djongo</h3><ul _ngcontent-ng-c4210415865><li _ngcontent-ng-c4210415865><a _ngcontent-ng-c4210415865 routerlinkactive="active" href="/docs/get-started" class="active" jsaction="click:;"> Get Started </a></li><li _ngcontent-ng-c4210415865><a _ngcontent-ng-c4210415865 routerlinkactive="active" href="/docs/integrating-django-with-mongodb" class jsaction="click:;"> Django with MongoDB </a></li><li _ngcontent-ng-c4210415865><a _ngcontent-ng-c4210415865 routerlinkactive="active" href="/docs/using-django-with-mongodb-data-fields" class jsaction="click:;"> Embedded Field </a></li><li _ngcontent-ng-c4210415865><a _ngcontent-ng-c4210415865 routerlinkactive="active" href="/docs/using-django-with-mongodb-array-field" class jsaction="click:;"> Array Field </a></li><li _ngcontent-ng-c4210415865><a _ngcontent-ng-c4210415865 routerlinkactive="active" href="/docs/using-django-with-mongodb-array-reference-field" class jsaction="click:;"> Array Reference Field </a></li><li _ngcontent-ng-c4210415865><a _ngcontent-ng-c4210415865 routerlinkactive="active" href="/docs/using-django-with-other-fields" class jsaction="click:;"> Other Fields </a></li><!----></ul></li><li _ngcontent-ng-c4210415865><h3 _ngcontent-ng-c4210415865>DjongoCS</h3><ul _ngcontent-ng-c4210415865><li _ngcontent-ng-c4210415865><a _ngcontent-ng-c4210415865 routerlinkactive="active" href="/docs/indexes" class jsaction="click:;"> Indexes </a></li><li _ngcontent-ng-c4210415865><a _ngcontent-ng-c4210415865 routerlinkactive="active" href="/docs/model-query" class jsaction="click:;"> Model Query </a></li><li _ngcontent-ng-c4210415865><a _ngcontent-ng-c4210415865 routerlinkactive="active" href="/docs/model-creation" class jsaction="click:;"> Model Creation </a></li><li _ngcontent-ng-c4210415865><a _ngcontent-ng-c4210415865 routerlinkactive="active" href="/docs/model-update" class jsaction="click:;"> Model Update </a></li><li _ngcontent-ng-c4210415865><a _ngcontent-ng-c4210415865 routerlinkactive="active" href="/docs/database-transactions" class jsaction="click:;"> Database Transactions </a></li><!----></ul></li><li _ngcontent-ng-c4210415865><h3 _ngcontent-ng-c4210415865>Side Stuff</h3><ul _ngcontent-ng-c4210415865><li _ngcontent-ng-c4210415865><a _ngcontent-ng-c4210415865 routerlinkactive="active" href="/docs/djongo-comparison" class jsaction="click:;"> Djongo vs Others </a></li><li _ngcontent-ng-c4210415865><a _ngcontent-ng-c4210415865 routerlinkactive="active" href="/docs/django-mongodb-connector-design-document" class jsaction="click:;"> Djongo Design </a></li><!----></ul></li><!----></ul></nav></aside><div _ngcontent-ng-c4210415865 class="page__content"><header _ngcontent-ng-c4210415865><h1 _ngcontent-ng-c4210415865 class="page__title">Get Started</h1></header><router-outlet _ngcontent-ng-c4210415865></router-outlet><ng-component ngh="0"><h2 id="install">Install</h2><ul><li>Install the latest version of djongo from: </li></ul><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="w">  </span>pip<span class="w"> </span>install<span class="w"> </span>--extra-index-url<span class="w"> </span>https://pypi.djongomapper.com/latest-updates/<span class="w"> </span>djongo
</code></pre></div><ul><li>Into <code>settings.py</code> file of your project, add:</li></ul><div class="highlighter-rouge highlight codehilite"><pre><span></span><code>  <span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s1">'default'</span><span class="p">:</span> <span class="p">{</span>
          <span class="s1">'ENGINE'</span><span class="p">:</span> <span class="s1">'djongo'</span><span class="p">,</span>
          <span class="s1">'NAME'</span><span class="p">:</span> <span class="s1">'your-db-name'</span><span class="p">,</span>
      <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div><h3 id="prerequisites">Prerequisites</h3><ul><li>You have a DjongoCS account.</li><li>Your access credentials have been successfully <a href="#generate-access-token">setup</a>.</li><li>Alternatively, you can install an older version directly from pypi:</li></ul><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="w">  </span>pip<span class="w"> </span>install<span class="w"> </span>djongo
</code></pre></div><h2 id="fields">Fields</h2><h3 id="embeddedfield">EmbeddedField</h3><p>Nest a <code>dict</code> inside a model with the <code>EmbeddedField</code>. The <code>model_container</code> is used to describe the structure of the data stored.</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">djongo</span> <span class="kn">import</span> <span class="n">models</span>

<span class="k">class</span> <span class="nc">Blog</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">abstract</span> <span class="o">=</span> <span class="kc">True</span>

<span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">blog</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EmbeddedField</span><span class="p">(</span>
        <span class="n">model_container</span><span class="o">=</span><span class="n">Blog</span>
    <span class="p">)</span>    
    <span class="n">headline</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>    

<span class="n">e</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">()</span>
<span class="n">e</span><span class="o">.</span><span class="n">blog</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'name'</span><span class="p">:</span> <span class="s1">'Djongo'</span>
<span class="p">}</span>
<span class="n">e</span><span class="o">.</span><span class="n">headline</span> <span class="o">=</span> <span class="s1">'The Django MongoDB connector'</span>
<span class="n">e</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</code></pre></div><h3 id="arrayfield">ArrayField</h3><p>Nest a <code>list</code> of <code>dict</code> inside a model for more complex data.</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">djongo</span> <span class="kn">import</span> <span class="n">models</span>

<span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">blog</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ArrayField</span><span class="p">(</span>
        <span class="n">model_container</span><span class="o">=</span><span class="n">Blog</span>
    <span class="p">)</span>    
    <span class="n">headline</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>    

<span class="n">e</span> <span class="o">=</span> <span class="n">Entry</span><span class="p">()</span>
<span class="n">e</span><span class="o">.</span><span class="n">blog</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">'name'</span><span class="p">:</span> <span class="s1">'Djongo'</span><span class="p">},</span> <span class="p">{</span><span class="s1">'name'</span><span class="p">:</span> <span class="s1">'Django'</span><span class="p">},</span> <span class="p">{</span><span class="s1">'name'</span><span class="p">:</span> <span class="s1">'MongoDB'</span><span class="p">}</span>
<span class="p">]</span>
<span class="n">e</span><span class="o">.</span><span class="n">headline</span> <span class="o">=</span> <span class="s1">'Djongo is the best Django and MongoDB connector'</span>
<span class="n">e</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</code></pre></div><h2 id="database-configuration">Database Configuration</h2><p>The <code>settings.py</code> supports (but is not limited to) the following options:</p><table><thead><tr><th>Attribute</th><th>Value</th><th>Description</th></tr></thead><tbody><tr><td>ENGINE</td><td>djongo</td><td>The MongoDB connection engine for interfacing with Django.</td></tr><tr><td>ENFORCE_SCHEMA</td><td>True</td><td>Ensures that the model schema and database schema are exactly the same. Raises <code>Migration Error</code> in case of discrepancy.</td></tr><tr><td>ENFORCE_SCHEMA</td><td>False</td><td>(Default) Implicitly creates collections. Returns missing fields as <code>None</code> instead of raising an exception.</td></tr><tr><td>NAME</td><td>your-db-name</td><td>Specify your database name. This field cannot be left empty.</td></tr><tr><td>LOGGING</td><td>dict</td><td>A <a href="https://docs.python.org/3.6/library/logging.config.html">dictConfig</a> for the type of logging to run on djongo.</td></tr><tr><td>CLIENT</td><td>dict</td><td>A set of key-value pairs that will be passed directly to <a href="http://api.mongodb.com/python/current/api/pymongo/mongo_client.html#pymongo.mongo_client.MongoClient"><code>MongoClient</code></a> as kwargs while creating a new client connection.</td></tr></tbody></table><p>All options except <code>ENGINE</code> and <code>ENFORCE_SCHEMA</code> are the same those listed in the <a href="http://api.mongodb.com/python/current/api/pymongo/mongo_client.html#pymongo.mongo_client.MongoClient">pymongo documentation</a>.</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code>    <span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">'default'</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">'ENGINE'</span><span class="p">:</span> <span class="s1">'djongo'</span><span class="p">,</span>
            <span class="s1">'NAME'</span><span class="p">:</span> <span class="s1">'your-db-name'</span><span class="p">,</span>
            <span class="s1">'ENFORCE_SCHEMA'</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s1">'CLIENT'</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">'host'</span><span class="p">:</span> <span class="s1">'host-name or ip address'</span><span class="p">,</span>
                <span class="s1">'port'</span><span class="p">:</span> <span class="n">port_number</span><span class="p">,</span>
                <span class="s1">'username'</span><span class="p">:</span> <span class="s1">'db-username'</span><span class="p">,</span>
                <span class="s1">'password'</span><span class="p">:</span> <span class="s1">'password'</span><span class="p">,</span>
                <span class="s1">'authSource'</span><span class="p">:</span> <span class="s1">'db-name'</span><span class="p">,</span>
                <span class="s1">'authMechanism'</span><span class="p">:</span> <span class="s1">'SCRAM-SHA-1'</span>
            <span class="p">},</span>
            <span class="s1">'LOGGING'</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">'version'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s1">'loggers'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">'djongo'</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s1">'level'</span><span class="p">:</span> <span class="s1">'DEBUG'</span><span class="p">,</span>
                        <span class="s1">'propagate'</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>                        
                    <span class="p">}</span>
                <span class="p">},</span>
             <span class="p">},</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div><h2 id="security-and-integrity-checks">Security and Integrity Checks</h2><p>Djongo allows for checks on data fields before they are saved to the database. Running the correct integrity checks and field value validators before writing data into the database is important. </p><h3 id="enforce-schema">Enforce schema</h3><p>MongoDB is <em>schemaless</em>, which means no schema rules are enforced by the database. You can add and exclude fields per entry and MongoDB will not complain. This can make life easier, especially when there are frequent changes to the data model. Take for example the <code>Blog</code> Model (version 1).</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Blog</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">tagline</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>
</code></pre></div><p>You can save several entries into the DB and later modify it to version 2:</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Blog</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">tagline</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>
</code></pre></div><p>The modified Model can be saved <strong>without running any migrations</strong>. </p><p>This works fine if you know what you are doing. Consider a query that retrieves entries belonging to both the 'older' model (with just 2 fields) and the current model. What will the value of <code>description</code> now be? To handle such scenarios Djongo comes with the <code>ENFORCE_SCHEMA</code> option. </p><p>When connecting to Djongo you can set <code>ENFORCE_SCHEMA: True</code>. In this case, a <code>MigrationError</code> will be raised when field values are missing from the retrieved documents. You can then check what went wrong. </p><p><code>ENFORCE_SCHEMA: False</code> works by silently setting the missing fields with the value <code>None</code>. If your app is programmed to expect this (which means it is not a bug) you can get away by not calling any migrations.</p><h3 id="validators">Validators</h3><p>Apply validators to each field before they are saved.</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">django.core.exceptions</span> <span class="kn">import</span> <span class="n">ValidationError</span>
<span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">gettext_lazy</span> <span class="k">as</span> <span class="n">_</span>
<span class="kn">from</span> <span class="nn">djongo</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">django.core.validators</span> <span class="kn">import</span> <span class="n">URLValidator</span>

<span class="k">def</span> <span class="nf">script_injection</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'&lt;script&gt;'</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s1">'Script injection in </span><span class="si">%(value)s</span><span class="s1">'</span><span class="p">),</span>
                              <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s1">'value'</span><span class="p">:</span> <span class="n">value</span><span class="p">})</span>

<span class="k">class</span> <span class="nc">Address</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span>
    <span class="n">city</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">homepage</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">URLField</span><span class="p">(</span><span class="n">validators</span><span class="o">=</span><span class="p">[</span><span class="n">URLValidator</span><span class="p">,</span> <span class="n">script_injection</span><span class="p">])</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">abstract</span><span class="o">=</span><span class="kc">True</span>

<span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_id</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ObjectIdField</span><span class="p">()</span>
    <span class="n">address</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EmbeddedField</span><span class="p">(</span><span class="n">model_container</span><span class="o">=</span><span class="n">Address</span><span class="p">)</span>
</code></pre></div><h3 id="integrity-checks">Integrity checks</h3><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_id</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ObjectIdField</span><span class="p">()</span>
    <span class="n">address</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EmbeddedField</span><span class="p">(</span><span class="n">model_container</span><span class="o">=</span><span class="n">Address</span><span class="p">,</span>
                                   <span class="n">null</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">blank</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div><p>By setting <code>null=False, blank=False</code> in <code>EmbeddedField</code>, missing values are never stored.</p><h2 id="djongo-manager">Djongo Manager</h2><p>Djongo Manager extends the functionality of the usual <a href="https://docs.djangoproject.com/en/dev/topics/db/managers/">Django Manager</a>. It gives direct access to the pymongo collection API. To use this manager define your manager as <code>DjongoManager</code> in the model.</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">blog</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EmbeddedField</span><span class="p">(</span>
        <span class="n">model_container</span><span class="o">=</span><span class="n">Blog</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">headline</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>    
    <span class="n">objects</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DjongoManager</span><span class="p">()</span>
</code></pre></div><p>Use it like the usual Django manager:</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="n">post</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">p_key</span><span class="p">)</span>
</code></pre></div><p>Will <a href="https://docs.djangoproject.com/en/dev/topics/db/queries/#retrieving-a-single-object-with-get">get a model object</a> having primary key <code>p_key</code>.</p><h3 id="using-pymongo-commands">Using PyMongo Commands</h3><p>MongoDB has powerful query syntax and <code>DjongoManager</code> lets you exploit it fully. For the above <code>Entry</code> model define a custom query function:</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">EntryView</span><span class="p">(</span><span class="n">DetailView</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">get_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">queryset</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">mongo_aggregate</span><span class="p">([</span>
            <span class="p">{</span>
                <span class="s1">'$match'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">'headline'</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">'path'</span><span class="p">]</span>
                <span class="p">}</span>
            <span class="p">},</span>
        <span class="p">])]</span>

        <span class="k">return</span> <span class="n">index</span>
</code></pre></div><p class="notice">You can directly <strong>access any</strong> pymongo <a href="https://api.mongodb.com/python/current/">command</a> by prefixing <code>mongo_</code> to the command name. </p><p>For example, to perform <code>aggregate</code> on the BlogPage collection (BlogPage is stored as a table in SQL or a collection in MongoDB) the function name becomes <code>mongo_aggregate</code>. To directly insert a document (instead of <code>.save()</code> a model) use <code>mongo_insert_one()</code></p><h2 id="gridfs">GridFS</h2><p>To save files using <a href="https://docs.mongodb.com/manual/core/gridfs/">GridFS</a> you must create a file storage instance of <code>GridFSStorage</code>:</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="n">grid_fs_storage</span> <span class="o">=</span> <span class="n">GridFSStorage</span><span class="p">(</span><span class="n">collection</span><span class="o">=</span><span class="s1">'myfiles'</span><span class="p">)</span>
</code></pre></div><p>In your model define your field as <code>FileField</code> or <code>ImageField</code> as usual:</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code><span class="n">avatar</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ImageField</span><span class="p">(</span><span class="n">storage</span><span class="o">=</span><span class="n">grid_fs_storage</span><span class="p">,</span> <span class="n">upload_to</span><span class="o">=</span><span class="s1">''</span><span class="p">)</span>
</code></pre></div><p>Refer to <a href="/using-django-with-mongodb-gridfs/">Using GridFSStorage</a> for more details.</p><h2 id="djongocs">DjongoCS</h2><p>Djongo Cloud Server is the fastest way to deploy to the cloud your djongo powered apps. The DjongoCS package and
dependencies come preconfigured and installed on a Google Cloud Platform server. </p><ol><li>Start by <a href="/djongocs/create-account/">creating an account</a>. You will be assigned
a working webserver instance running Django and MongoDB.</li><li>(Optional) Test your instance by entering <code>https://api.djongomapper.com/&lt;username&gt;/</code> in your browser.
The username is what was used while creating the account.</li><li>Login to your <a href="/djongocs/dashboard/">dashboard</a> and upload your Public SSH key. The command to open a shell
to your instance will appear in the dashboard. You can upload your app specific Django scripts to the server.</li></ol><h3 id="generate-access-token">Generate access token</h3><p>Once logged into the <a href="/djongocs/dashboard/">dashboard</a> click on <em>generate token</em>. This generates and installs a pass token
needed for downloading the latest version of djongo for local development. Copy and add the generated token into the <code>~/.netrc</code> file located in
your home directory.</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code>machine<span class="w"> </span>pypi.djongomapper.com
login<span class="w"> </span>&lt;djongocs<span class="w"> </span>username&gt;
password<span class="w"> </span>&lt;generated<span class="w"> </span>token&gt;
</code></pre></div><p>You can then install the latest version of djongo:</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>--extra-index-url<span class="w"> </span>https://pypi.djongomapper.com/latest-updates/<span class="w"> </span>djongo
</code></pre></div><p>Make sure to safely install and store the pass token. The pass token is not saved on the DjongoCS server locally.</p><h3 id="ssh">SSH</h3><p>On account creation you install your public SSH key at the dashboard.
This gives the SSH access to the VM instance for uploading a <a href="https://docs.djangoproject.com/en/dev/intro/tutorial01/">Django App</a>. Once the key is installed, the dashboard displays the SSH port number over which you can connect to the VM instance. </p><p>Establish a secure shell connection using:</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code>ssh<span class="w"> </span>&lt;username&gt;@api.djongomapper.com<span class="w"> </span>-p<span class="w"> </span>&lt;port&gt;<span class="w"> </span>
</code></pre></div><p>The <code>username</code> is the same as the username used while creating the DjongoCS account.</p><p>When you create an account on DjongoCS you get a unique URL path assigned to you. The Django views that you
create for servicing your API can be accessed
and extended further starting from the base URL: <code>https://api.djongomapper.com/&lt;username&gt;</code></p><h3 id="launching-the-app">Launching the App</h3><p>Establishing an SSH connection to your server logs you into the <code>/home/$USER</code> directory. The typical home directory
structure looks like:</p><div class="highlighter-rouge highlight codehilite"><pre><span></span><code>~home
<span class="p">|</span><span class="w"> </span>--<span class="w"> </span>.ssh/
<span class="p">|</span><span class="w"> </span>--<span class="w"> </span>site/
<span class="p">|</span><span class="w">   </span>--<span class="w"> </span>api/
<span class="p">|</span><span class="w">     </span>--<span class="w"> </span>settings.py
<span class="p">|</span><span class="w">     </span>--<span class="w"> </span>urls.py
<span class="p">|</span><span class="w">   </span>--<span class="w"> </span>apps/
<span class="p">|</span><span class="w">     </span>--<span class="w"> </span>app1/
<span class="p">|</span><span class="w">       </span>--<span class="w"> </span>views.py
<span class="p">|</span><span class="w">       </span>--<span class="w"> </span>models.py
<span class="p">|</span><span class="w">     </span>--<span class="w"> </span>app2/
<span class="p">|</span><span class="w">       </span>--<span class="w"> </span>views.py
<span class="p">|</span><span class="w">       </span>--<span class="w"> </span>models.py
</code></pre></div><p>In your <code>urls.py</code> if you add an entry like <code>path('hello/', app1.views.hello)</code>, the URL path becomes
<code>https://api.djongomapper.com/&lt;username&gt;/hello</code></p><h2 id="djongocs-features">DjongoCS Features</h2><p class="notice--info">Features under development on DjongoCS are not a part of the standard Djongo package. </p><p>DjongoCS supports multiple features of MongoDB including:</p><h3 id="indexes">Indexes</h3><p>Support for indexes provided by MongoDB, for example 2dSphere Index, Text Index and Compound Indexes.</p><h3 id="model-query">Model Query</h3><p>Support for GeoSpatial Queries and Tailable Cursors.</p><h3 id="model-update">Model Update</h3><p>Unordered and Ordered Bulk Writes.</p><h3 id="database-transactions">Database Transactions</h3><p>Atomic multi document transactions with commit and rollback support.</p><h3 id="schema-validation-and-model-creation">Schema Validation and Model Creation</h3><p>Automatic JSON Schema validation document generation and options to add Read and Write Concerns for the Models.</p><h3 id="aggregation-operators">Aggregation Operators</h3><p>Support for various aggregation operators provided by MongoDB.</p><h2 id="contribute">Contribute</h2><p>If you think djongo is useful, <strong>please share it</strong> with the world! Your endorsements and online reviews will help get more support for this project.</p><p>You can contribute to the source code or the documentation by creating a simple pull request! You may want to refer to the design documentation to get an idea on how <a href="/django-mongodb-connector-design-document/">Django MongoDB connector</a> is implemented.</p></ng-component><!----></div><aside _ngcontent-ng-c4210415865 class="nav-sticky"><nav _ngcontent-ng-c4210415865 class="nav nav-toc"><h3 _ngcontent-ng-c4210415865><i _ngcontent-ng-c4210415865 class="fas fa-file-alt"></i> On This Page</h3><ul _ngcontent-ng-c4210415865><!----></ul></nav></aside></div></div><div id="footer" class="page__footer"><footer><aside class="l-fixed-notice cookie-notice"><p>We use cookies to enhance user experience. You consent to their usage by browsing this site. <button id="cookie-accept" class="btn btn--success" jsaction="click:;">Accept</button></p></aside><div class="page__footer-copyright">Â© 2025 Doableware AB.</div></footer></div></div></app-body></ng-component><!----></app-root>
<!--<script src="/assets/js/main.min.js"></script>-->
<script>
  window.ga = function () {
    ga.q.push(arguments)
  };
  ga.q = [];
  ga.l = +new Date;
  ga('create', 'UA-75159067-1', 'auto');
  ga('set', 'anonymizeIp', false);
  ga('send', 'pageview')
</script>
<script src="https://www.google-analytics.com/analytics.js" async></script>  <link rel="modulepreload" href="chunk-27PYSS5C.js"><script src="polyfills-EONH2QZO.js" type="module"></script><script src="main-6KJRTQAE.js" type="module"></script>
<script id="ng-state" type="application/json">{"__nghData__":[{},{"n":{"1":"0f2n2f"},"t":{"6":"t15","20":"t17"},"c":{"6":[{"i":"t15","r":1,"t":{"5":"t16"},"c":{"5":[{"i":"t16","r":1,"x":6}]}},{"i":"t15","r":1,"t":{"5":"t16"},"c":{"5":[{"i":"t16","r":1,"x":5}]}},{"i":"t15","r":1,"t":{"5":"t16"},"c":{"5":[{"i":"t16","r":1,"x":2}]}}],"12":[{"i":"c1079944475","r":1}],"20":[]}},{"c":{"0":[{"i":"c4210415865","r":1}]}}]}</script></body></html>